{"version":3,"file":"index.js","sources":["../../src/resource.ts","../../src/spine/SpineModuleLoader.ts","../../src/spine/SpineController.ts","../../src/spine/SpinePlugin.ts"],"sourcesContent":[null,null,null,null],"names":["resourceCounter","defineResource","defaultValue","name","id","_id","Symbol","_name","_default","async","loadSpineModule","wasmUrl","factory","moduleFactory","import","default","delta","elapsed","frameCount","SpineModuleController","constructor","spineModule","this","module_","listeners_","Map","module","loadSkeleton","skelPath","atlasText","isBinary","spine_loadSkeleton","length","unloadSkeleton","handle","spine_unloadSkeleton","getAtlasPageCount","spine_getAtlasPageCount","getAtlasPageTextureName","pageIndex","spine_getAtlasPageTextureName","setAtlasPageTexture","textureId","width","height","spine_setAtlasPageTexture","createInstance","skeletonHandle","spine_createInstance","destroyInstance","instanceId","spine_destroyInstance","delete","play","animation","loop","track","spine_playAnimation","addAnimation","delay","spine_addAnimation","setSkin","skinName","spine_setSkin","update","dt","spine_update","getAnimations","json","spine_getAnimations","JSON","parse","getSkins","spine_getSkins","getBonePosition","boneName","xPtr","_malloc","yPtr","spine_getBonePosition","_free","x","HEAPF32","y","getBoneRotation","spine_getBoneRotation","getBounds","ptr","spine_getBounds","f32","base","result","extractMeshBatches","batchCount","spine_getMeshBatchCount","batches","metaPtr","texIdPtr","blendPtr","i","vertexCount","spine_getMeshBatchVertexCount","indexCount","spine_getMeshBatchIndexCount","vertBytes","idxBytes","vertPtr","idxPtr","spine_getMeshBatchData","vertices","Float32Array","buffer","indices","Uint16Array","HEAPU8","push","HEAPU32","blendMode","on","entity","type","callback","has","set","entityListeners","get","Set","add","off","typeListeners","removeAllListeners","SpineResource","SpinePlugin","wasmUrl_","factory_","build","app","coreModule","wasmModule","initPromise","then","controller","insertResource","__spineInitPromise","submitSpineMeshesToCore","transform","transformPtr","batch","byteLength","renderer_submitTriangles"],"mappings":"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"}