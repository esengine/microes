{"version":3,"file":"index.js","sources":["../../src/resource.ts","../../src/spine/SpineModuleLoader.ts","../../src/spine/SpineController.ts","../../src/spine/SpinePlugin.ts"],"sourcesContent":[null,null,null,null],"names":["resourceCounter","defineResource","defaultValue","name","id","_id","Symbol","_name","_default","wrapSpineModule","raw","cw","cwrap","bind","loadSkeleton","getLastError","unloadSkeleton","getAtlasPageCount","getAtlasPageTextureName","setAtlasPageTexture","createInstance","destroyInstance","playAnimation","addAnimation","setSkin","update","getAnimations","getSkins","getBonePosition","getBoneRotation","getBounds","getMeshBatchCount","getMeshBatchVertexCount","getMeshBatchIndexCount","getMeshBatchData","async","loadSpineModule","wasmUrl","factory","moduleFactory","import","default","api","delta","elapsed","frameCount","SpineModuleController","constructor","this","raw_","api_","listeners_","Map","skelData","atlasText","isBinary","ptr","len","bytes","TextEncoder","encode","length","_malloc","HEAPU8","set","result","_free","handle","pageIndex","textureId","width","height","skeletonHandle","instanceId","delete","play","animation","loop","track","delay","skinName","dt","json","JSON","parse","boneName","xPtr","yPtr","x","HEAPF32","y","f32","base","extractMeshBatches","batchCount","batches","metaPtr","texIdPtr","blendPtr","i","vertexCount","indexCount","vertBytes","idxBytes","vertPtr","idxPtr","vertices","Float32Array","buffer","indices","Uint16Array","push","HEAPU32","blendMode","on","entity","type","callback","has","entityListeners","get","Set","add","off","typeListeners","removeAllListeners","SpineResource","SpinePlugin","wasmUrl_","factory_","build","app","coreModule","wasmModule","initPromise","then","controller","insertResource","__spineInitPromise","_spineDiagFrame","_spineDiagPrevSignature","submitSpineMeshesToCore","transform","color","issues","sigParts","b","vertCount","v","u","vv","vi","isNaN","toFixed","maxIdx","j","sig","join","console","warn","uniqueIssues","slice","error","summary","map","log","diagValidateBatches","transformPtr","needsTint","z","w","batch","byteLength","renderer_submitTriangles"],"mappings":"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"}